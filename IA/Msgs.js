const textkeep = {}
const defaultans = {}
const defdef = ['NÃ£o reconheci o que vocÃª enviou.', 'Poderia responder minha pergunta anterior?']
const messages = []

//--------TODO--------//
/**
 * 
 */ 

class StepStuff{
    constructor(tags=[], actions=[], msg=[]){
        for (let i in tags)
            this[tags[i][0]] = { alts:tags[i].slice(1), actions:(actions[i]?actions[i]:[]), msg:(msg[i]?msg[i]:[]) }
    }

    getTags(){
        return Object.keys(this).map((i) => {let j = [i]; j.push(...this[i].alts); return j})
    }

    getActions(){
        return Object.keys(this).map((i) => this[i].actions)
    }
}

/**
 * Novo Modelo de organizaÃ§Ã£o das mensagens:
 * O array message contÃ©m em cada item as informaÃ§Ãµes pra criaÃ§Ã£o de um bloco, assim como os steps deste
 * bloco. A composiÃ§Ã£o dos itens do array Ã©:
 *  {from, to, step(array com os steps)}
 * JÃ¡ os steps, sÃ£o configurados no formato:
 * {txt, full, unf(estes dois sÃ£o instancias de StepStuff), def, from, to}
 */

messages.push(...[
{
'txt':['OlÃ¡! Sou um bot programado para auxiliar o processo de matrÃ­cula do IFMA.', 'VocÃª gostaria de fazer sua rematrÃ­cula?'],
'full': new StepStuff([['~sim~']], [], []),
'unf': {},
'def':['VocÃª sÃ³ precisa me confirmar a qualquer momento para continuarmos.'],
'to':[1]},

{
'txt': ['Certo. Vamos iniciar o processo para fazer sua rematrÃ­cula.', 'De inÃ­cio, sÃ³ vou precisar de algumas informaÃ§Ãµes suas, como' + 
    ' seu cÃ³digo de matrÃ­cula e CPF.', 'Toda vez que vocÃª me enviar alguma informaÃ§Ã£o, eu irei confirmar com vocÃª se ela tÃ¡ certa, entÃ£o nÃ£o' + 
    ' precisa se preocupar se mandar alguma informaÃ§Ã£o errada.', 'Se houver algum problema durante esse processo, basta ler a descriÃ§Ã£o' + 
    ' deste perfil.', 'Se vocÃª estiver pronto para iniciar, basta me mandar um "Tudo pronto".'],
'full': new StepStuff([['pronto']], [[]], [[]]),
'unf': new StepStuff([[]], [[]], [[]]),  //Perguntas????
'def': ['Basta me confirmar com um "Tudo pronto".'],
'to': [2]},

{
'txt':['Primeiramente me informe seu cÃ³digo de matrÃ­cula.'],
'full': new StepStuff([['~mat~']], [['prepareUser']], [[]]),
'unf': new StepStuff([['~matex~'], ['!num!']], [], [['Estanho, jÃ¡ tenho um registro com essa matrÃ­cula.', 'Talvez vocÃª digitou a' + 
    ' matrÃ­cula errada? Ou vocÃª jÃ¡ fez a rematrÃ­cula?', 'Se for o primeiro caso, Ã© sÃ³ enviar a matrÃ­cula correta, agora se vocÃª ainda nÃ£o' + 
    ' fez a matrÃ­cula e isso tÃ¡ aparecendo pra vocÃª, tente contatar alguÃ©m do departamento. Neste caso, basta me enviar "Contatar departamento".'], 
    ['Por favor, me mande um cÃ³digo de matrÃ­cula vÃ¡lido.'], 
    ['Esse cÃ³digo de matrÃ­cula jÃ¡ estÃ¡ registrado.', 'VocÃª jÃ¡ fez seu registro?']]),
'def':['Preciso que me mande sua matrÃ­cula.'],
'to':[3]},


{
'txt':['Sua matrÃ­cula Ã© ~mat~. VocÃª confirma?'],
'full': new StepStuff([['~sim~']], [['effetivate']], []),
'unf': new StepStuff([['~nao~']], [['2']], [['Ok, me envie o cÃ³digo de matrÃ­cula correto agora ğŸ¤¨']]),
'def':['VocÃª sÃ³ precisa me mandar um "sim" ou "nÃ£o" para confirmar.'],
'to':[4]},

{
'txt':['Agora me informe seu nome completo.'],
'full': new StepStuff([['~nome~']], [['updateUser']], []),
'unf': new StepStuff([['~1-wrd~']], [], [['Poderia rever o nome que vocÃª enviou?', 'Eu pedi que me enviasse ' + 
'seu nome completo, mas vocÃª sÃ³ me enviou uma palavra.']]),
'def':['Por favor, me informe seu nome.'],
'to':[5]},

{
'txt':['Seu nome completo Ã© ~nome~. VocÃª confirma?'],
'full': new StepStuff([['~sim~']], [['effetivate']], []),
'unf': new StepStuff([['~nao~']], [['4']], [['Ok, me envie o nome correto agora ğŸ¤¨']]),
'def':['VocÃª sÃ³ precisa me mandar um "sim" ou "nÃ£o" para confirmar.'],
'to':[6]},

{
'txt':['Agora me informe seu Email.'],
'full': new StepStuff([['~email~']], [['updateUser']], []),
'unf': new StepStuff([['*@']], [], [['Me envie um email vÃ¡lido, por favor.']]),
'def':['Preciso do seu email.'],
'to':[7]},

{
'txt':['Seu email Ã© ~email~. VocÃª confirma?'],
'full': new StepStuff([['~sim~']], [['effetivate']], []),
'unf': new StepStuff([['~nao~']], [['6']], [['Ok, me envie o email correto agora ğŸ¤¨']]),
'def':['VocÃª sÃ³ precisa me mandar um "sim" ou "nÃ£o" para confirmar.'],
'to':[8]},

{
'txt':['Agora preciso saber qual Ã© o seu curso.'],
'full': new StepStuff([['~curso~']], [['updateUser']], []),
'unf': new StepStuff([['~sim~', '~nao~']], [], [['SÃ³ precisa me enviar o nome do seu curso.']]),
'def':['Por favor, me mande o nome do seu curso.', 'Ã‰ preciso ser um dos 4 do nosso campus: ' + 
'AdministraÃ§Ã£o, Engenharia da ComputaÃ§Ã£o, FÃ­sica ou ConstruÃ§Ã£o de EdifÃ­cios.'],
'to':[9]},

{
'txt':['Beleza, e qual o ano da sua turma? (ano em que vocÃª ingressou na instituiÃ§Ã£o)'],
'full': new StepStuff([['~turma~']], [['insUpdateUser']], []),
'unf': new StepStuff([['~sim~', '~nao~']], [], [['SÃ³ precisa me enviar o ano da sua turma.']]),
'def':['Eu preciso do ano da sua turma, ou seja, o ano em que vocÃª entrou na instituiÃ§Ã£o.'],
'to':[10]},

{
'txt':['EntÃ£o vocÃª Ã© do curso ~curso~ da turma de ~turma~. VocÃª confirma?'],
'full': new StepStuff([['~sim~']], [['effetivate']], []),
'unf': new StepStuff([['~nao~']], [['8']], [['Ok, vamos voltar atrÃ¡s entÃ£o. Qual Ã© mesmo o seu curso?']]),
'def':['VocÃª sÃ³ precisa me mandar um "sim" ou "nÃ£o" para confirmar.'],
'to':[11]},

{
'txt':['Me informe seu CPF.'],
'full': new StepStuff([['~cpf~']], [['updateUser']], []),
'unf': new StepStuff([['~num~']], [], [['Por favor, me envie um cpf vÃ¡lido.', 'Ele deve conter exatamente 11 ' + 
    'dÃ­gitos.']]),
'def':['Por favor, me informe o seu CPF.'],
'to':[12]},

{
'txt':['Seu CPF Ã© ~cpf~. VocÃª confirma?'],
'full': new StepStuff([['~sim~']], [['effetivate', 'savedefdiscs']], [[]]),
'unf': new StepStuff([['~nao~']], [['11']], [['Ok, me envie o CPF correto agora ğŸ¤¨']]),
'def':['VocÃª sÃ³ precisa me mandar um "sim" ou "nÃ£o" para confirmar.'],
'to':[13]},

{
'txt':['Pronto. JÃ¡ tenho todas as informaÃ§Ãµes necessÃ¡rias para concluir a sua rematrÃ­cula.', 'Se vocÃª jÃ¡ quiser finalizar aqui, basta' + 
    'me mandar um "finalizar" e eu vou mandar seus dados para o departamento da rematrÃ­cula, mas se quiser, vocÃª ainda pode alterar a sua' + 
    ' matrÃ­cula.', 'A alteraÃ§Ã£o de matrÃ­cula Ã© basicamente onde vocÃª poderÃ¡ escolher se quer adicionar ou retirar alguma matÃ©ria da sua' + 
    ' carga horÃ¡ria desse perÃ­odo', 'Com base no seu curso e turma, adicionei estas matÃ©rias por padrÃ£o:~discesc~', 'Se quiser adicionar' + 
    ' ou retirar alguma matÃ©ria, basta me mandar "alterar matrÃ­cula".'],
'full': new StepStuff([['~finalizar~'], ['alterar']], [[], []], [[]]),
'unf': new StepStuff([[]], [[]], [[]]),
'def':['VocÃª sÃ³ precisa me mandar um "finalizar" ou "alterar" para continuarmos.'],
'to':[14, 15]},

{
'txt':['Tudo certo entÃ£o! JÃ¡ irei avisar o departamento da sua rematrÃ­cula e enviar seus dados.'],
'full': new StepStuff([['~nop~']], [[]], [[]]),
'unf': new StepStuff([['~voltar~']], [['13']], [[]]),
'def':['JÃ¡ concluÃ­mos o processo, mas vocÃª pode escolher voltar e fazer a alteraÃ§Ã£o de matrÃ­cula se quiser.', 'Neste caso, basta' + 
    ' me mandar "voltar".'],
'to':[13]},

//Step 15
{
'txt':['Agora nÃ³s comeÃ§aremos o processo de alteraÃ§Ã£o de matrÃ­cula, onde vocÃª poderÃ¡ escolher as matÃ©rias que irÃ¡ cursar neste perÃ­odo.', 
    'Estas sÃ£o as matÃ©rias que estÃ£o registradas para vocÃª por enquanto:~discesc~', ''
    ,'Agora nÃ³s comeÃ§aremos o processo de adicionar/retirar matÃ©rias.', 'Estas sÃ£o as matÃ©rias que estÃ£o registradas' +
    ' para vocÃª por enquanto:~discesc~', 'Se vocÃª jÃ¡ quiser parar por aqui e concluir sua rematrÃ­cula com a matÃ©rias da lista,' + 
    ' basta me mandar um "finalizar".', 'Para alterar as matÃ©rias que vocÃª irÃ¡ cursar, vocÃª sÃ³ precisa me mandar "adicionar"' + 
    ' para acrescentar alguma matÃ©ria que nÃ£o estÃ¡ na lista, ou "retirar" para remover alguma delas.', 'Sempre que vocÃª' + 
    ' fizer uma alteraÃ§Ã£o, vocÃª irÃ¡ voltar para este passo, e portanto pode repetir o processo atÃ© que tenha escolhido todas as matÃ©rias' + 
    ' que quiser.'],
'full': new StepStuff([['adicionar'], ['retirar'], ['~finalizar~']], [], []),
'unf': {},
'def':['SÃ³ dizer alguma das opÃ§Ãµes para continuarmos.'],
'to':[16, 17, 13]},

//Step 16
{
'txt':['Ok, agora vocÃª irÃ¡ selecionar as matÃ©rias que vocÃª deseja adicionar.', 'Para selecionÃ¡-las, basta me' + 
    ' mandar o id (nÃºmero) das matÃ©rias, pode mandar vÃ¡rios de uma vez. Em seguida eu vou te mostrar' + 
    ' os requisitos delas, para que vocÃª confirme que pode cursar a matÃ©ria.', 'NÃ£o precisa se preocupar' + 
    ' em escolher errado neste momento, vocÃª poderÃ¡ voltar se tiver escolhido alguma matÃ©ria errada.', 
    'Caso vocÃª nÃ£o queira escolher as matÃ©rias, basta me mandar um "voltar", para voltar pro passo anterior.',
    'VocÃª tambÃ©m pode me enviar "matriz curricular" ou "formulÃ¡rio" se quiser consultÃ¡-los novamente.',
    'Baseado no seu perfil, vocÃª provavelmente possui todos os requisitos para qualquer uma das matÃ©rias que' +
    ' estÃ£o nessa lista: ~recdisc~', 'NÃ£o precisa escolher dessa lista necessariamente, Ã© sÃ³ pra lhe dar' + 
    ' algumas ideias de matÃ©rias que vocÃª pode escolher.',],
'full': new StepStuff([['~matnums~'], ['~voltar~']], [['add_discs']], []),
'unf': {},
'def':['Basta me enviar os Ã­ndices das matÃ©rias para continuarmos!'],
'from':[13],
'to':[16, 13]},

//Step 17
{
'txt':['Certo, agora vocÃª irÃ¡ selecionar as matÃ©rias que deseja retirar.', 'Para selecionÃ¡-las, basta me' + 
    ' mandar o id (nÃºmero) das matÃ©rias, pode mandar vÃ¡rios de uma vez. Em seguida eu vou confirmar as' + 
    ' suas escolhas com vocÃª, entÃ£o nÃ£o precisa se preocupar em escolher errado agora, vocÃª poderÃ¡ voltar' + 
    ' se tiver escolhido alguma matÃ©ria errada.',
    'Caso vocÃª nÃ£o queira escolher as matÃ©rias, basta me mandar um "voltar", para voltar pro passo anterior.',
    'VocÃª tambÃ©m pode me enviar "matriz curricular" ou "formulÃ¡rio" se quiser consultÃ¡-los novamente.'],
'full': new StepStuff([['~matnums~'], ['~voltar~']], [['del_discs']], []),
'unf': {},
'def':['Basta me enviar os Ã­ndices das matÃ©rias para continuarmos!'],
'from':[13],
'to':[17, 13]},

//Step 18
{
'txt':['Agora vamos confirmar se vocÃª escolheu tudo certinho.',
    'Estas sÃ£o as matÃ©rias e seus requisitos:', '~instmatseladd~', 
    'Basta me dizer "sim" ou "nÃ£o" para confirmar as escolhas agora!'],
'full': new StepStuff([['~sim~'], ['~voltar~']], [['effetivate'], ['cleareff']], []),
'unf': new StepStuff([['~nao~']], [['goBack']], [['Ok. Pode reenviar os nÃºmeros das matÃ©rias que deseja adicionar.']]),
'def':['Basta me confirmar com um sim ou nÃ£o.'],
'recomp': {'any': 'SÃ³ precisa me dizer sim ou nÃ£o para confirmar as suas escolhas.'},
'from':[14],
'to':[18, 13]},

//Step 19
{
'txt':['VocÃª selecionou essas matÃ©rias: ~instmatseldel~', 
    'Basta me dizer "sim" ou "nÃ£o" para confirmar as escolhas agora!'],
'full': new StepStuff([['~sim~'], ['~voltar~']], [['effetivate'], ['cleareff']], []),
'unf': new StepStuff([['~nao~']], [['goBack']], [['Ok. Pode reenviar os nÃºmeros das matÃ©rias que deseja retirar.']]),
'def':['Basta me confirmar com um sim ou nÃ£o.'],
'recomp': {'any': 'SÃ³ precisa me dizer sim ou nÃ£o para confirmar as suas escolhas.'},
'from':[15],
'to':[18, 13]},

//Step 20
{
'txt':['OK, suas escolhas foram salvas.', 'Agora, vocÃª pode escolher se quer voltar e adicionar/retirar' + 
    ' outras matÃ©rias, basta me mandar "voltar".', 'Se vocÃª jÃ¡ tiver terminado com suas escolhas, basta' +
    ' me mandar "finalizar".', 'Estas foram suas escolhas atÃ© o momento:', '~discesc~'],
'full': new StepStuff([['~voltar~'], ['~finalizar~']], [[], ['finalize']], []),
'unf': {},
'def':['VocÃª sÃ³ precisa me mandar "finalizar" ou "voltar" para continuarmos com este processo.'],
'recomp': {'any': ['Basta me mandar "finalizar" ou "voltar" para continuarmos.']},
'from':[13],
'to':[13, 19]},

//Step 21
{
'txt':['Pronto! Estamos finalizados com a sua alteraÃ§Ã£o de matrÃ­cula.', /*'Eu irei te avisar quando o departamento', 
    ' tiver processado seu cadastro.', 'Neste ponto, vocÃª tambÃ©m pode requisitar refazer todo o processo', 
' para outra pessoa.'*/],
'full': new StepStuff([['~nop~']], [], []),
'unf': new StepStuff([['~nao~']], [['goBack']], [['Ok, me envie o nome correto agora ğŸ¤¨']]),
'def':['VocÃª sÃ³ precisa me mandar um "sim" ou "nÃ£o" para confirmar.'],
'from':[13],
'to':[14]},
])

const recorrent = {
    '~matriz~'      : ['~getmatriz~'],
    '~revisar~'     : ['Seus dados: ~userinfo~', '~discesc~'],
    '~depart~'      : ['~depart~']
}

export {textkeep, defaultans, defdef, messages, recorrent, StepStuff}
